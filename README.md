# نانو اچ‌تی‌تی‌پی‌دی (NanoHTTPD Sample)

یک اپلیکیشن قدرتمند اندروید برای اجرای و مدیریت پروژه‌های وب محلی با قابلیت دانلود وبسایت‌ها

## 🚀 ویژگی‌ها

### 🌐 سرور HTTP محلی
- اجرای سرور NanoHTTPD داخلی روی پورت 8080
- قابلیت اجرای پروژه‌های HTML/CSS/JavaScript به صورت محلی
- پشتیبانی کامل از فایل‌های استاتیک (تصاویر، فونت‌ها، ویدئوها)

### 📱 مدیریت پروژه‌ها
- **انتخابگر پروژه هوشمند**: با AutoCompleteTextView برای انتخاب سریع
- **مرورگر فایل**: امکان مشاهده ساختار فایل‌های پروژه
- **نمایشگر پروژه**: اجرای پروژه‌ها در WebView با پشتیبانی کامل JavaScript

### 🔽 دانلود حرفه‌ای وبسایت‌ها
- **سیستم دانلود پیشرفته**: معماری مدولار با FileSaver interface
- **دانلود کامل وبسایت‌ها**: دریافت تمام فایل‌های HTML، CSS، JS، تصاویر، فونت‌ها
- **پردازش هوشمند CSS**: تجزیه و دانلود منابع از داخل فایل‌های CSS
- **تبدیل URL های مطلق به نسبی** برای اجرای آفلاین کامل
- **مدیریت تکراری‌ها**: گزینه‌های Override، Skip یا Create New
- **پیگیری پیشرفت**: نمایش دقیق وضعیت دانلود با جزئیات
- **پشتیبانی کامل از انواع منابع**:
  - صفحات HTML و محتوای متنی
  - استایل‌شیت‌های CSS با تمام imports
  - اسکریپت‌های JavaScript
  - تصاویر (PNG, JPG, JPEG, GIF, SVG, WebP, ICO)
  - فونت‌ها (TTF, OTF, WOFF, WOFF2)
- **خطایابی پیشرفته**: مدیریت انواع خطاهای شبکه و اتصال

### 🎨 طراحی مدرن
- **تم Material Design 3** با پشتیبانی از حالت تاریک
- **فونت Rubik** با وزن‌های مختلف (Light تا Black)
- **UI فارسی** با پشتیبانی کامل RTL
- **رنگ‌بندی حرفه‌ای** با پالت Google Material

## 📋 نحوه استفاده

### اجرای پروژه‌های موجود
1. از لیست پروژه‌ها، یکی را انتخاب کنید
2. روی **"باز کردن پروژه"** کلیک کنید
3. پروژه در مرورگر داخلی اجرا می‌شود

### مرور فایل‌های پروژه
1. پروژه مورد نظر را انتخاب کنید
2. روی **"مرور فایل‌های پروژه"** کلیک کنید
3. ساختار فایل‌های پروژه نمایش داده می‌شود

### دانلود وبسایت
1. در بخش **"دانلود وبسایت"** آدرس سایت را وارد کنید
2. روی **"شروع دانلود"** کلیک کنید
3. در صورت وجود پروژه تکراری، گزینه مورد نظر را انتخاب کنید:
   - **جایگزین کردن**: پروژه قبلی حذف و جدید ایجاد شود
   - **پرش از دانلود**: دانلود متوقف شود
   - **ایجاد جدید**: پروژه جدید با timestamp ایجاد شود
4. پیشرفت دانلود را با جزئیات مشاهده کنید
5. وبسایت به عنوان پروژه جدید اضافه می‌شود

## 🛠 تکنولوژی‌های استفاده شده

### Backend
- **NanoHTTPD**: سرور HTTP سبک و قدرتمند
- **Kotlin Coroutines**: مدیریت عملیات ناهمزمان
- **OkHttp**: کتابخانه HTTP کلاینت

### UI/UX
- **Material Design 3**: آخرین استانداردهای طراحی Google
- **Constraint Layout**: چیدمان پیشرفته و انعطاف‌پذیر
- **Custom Font (Rubik)**: تایپوگرافی مدرن و خوانا

### Web Scraping & Download Engine
- **Jsoup**: پارس و تجزیه پیشرفته فایل‌های HTML
- **HtmlUtil**: ابزار تخصصی برای استخراج و پردازش منابع CSS
- **WebpageDownloader**: موتور دانلود حرفه‌ای با FileSaver interface
- **DefaultFileSaver**: پیاده‌سازی پایه برای ذخیره فایل‌ها
- **WebpageDownloadController**: کنترلر UI برای مدیریت دانلود
- **Auto URL Resolution**: تبدیل خودکار URL های نسبی به مطلق
- **CSS Parser**: پارسر تخصصی برای استخراج url() و @import در CSS

## 📁 ساختار پروژه

```
app/
├── src/main/
│   ├── java/com/practice/nanohttpd/
│   │   ├── MainActivity.kt              # صفحه اصلی با UI مدیریت
│   │   ├── ProjectActivity.kt           # نمایشگر پروژه‌ها در WebView
│   │   ├── ProjectFilesActivity.kt      # مرورگر فایل‌ها
│   │   ├── LocalHttpServer.kt           # سرور NanoHTTPD محلی
│   │   ├── WebpageDownloadController.kt # کنترلر UI برای مدیریت دانلود
│   │   ├── WebpageDownloader.kt         # موتور اصلی دانلود وبسایت‌ها
│   │   ├── DefaultFileSaver.kt          # پیاده‌سازی FileSaver interface
│   │   └── HtmlUtil.kt                  # ابزارهای پردازش HTML/CSS
│   ├── res/
│   │   ├── font/                        # فونت‌های Rubik (Light تا Black)
│   │   ├── layout/                      # فایل‌های Layout با Material 3
│   │   ├── values/                      # رنگ‌ها، رشته‌ها فارسی، تم‌ها
│   │   └── xml/                         # تنظیمات امنیت شبکه
│   └── assets/projects/                 # پروژه‌های نمونه پیش‌فرض
└── build.gradle.kts                     # وابستگی‌ها (بهینه‌سازی شده)
```

## 🔧 وابستگی‌های پروژه

### Core Dependencies (بهینه‌سازی شده)
- **NanoHTTPD 2.3.1**: سرور HTTP سبک و قدرتمند
- **OkHttp 4.12.0**: کلاینت HTTP برای دانلود منابع
- **Jsoup 1.17.1**: پارسر و تحلیلگر HTML
- **Kotlin Coroutines 1.7.3**: مدیریت عملیات ناهمزمان

### UI Framework  
- **Material Components**: کامپوننت‌های Material Design 3
- **AndroidX Core KTX**: اکستنشن‌های Kotlin
- **ConstraintLayout**: سیستم چیدمان پیشرفته

### حذف شده (unused dependencies)
- ~~Retrofit~~ - حذف شده (استفاده نمی‌شد)
- ~~Gson Converter~~ - حذف شده (استفاده نمی‌شد)  
- ~~OkHttp Logging Interceptor~~ - حذف شده (استفاده نمی‌شد)

## 📱 حداقل نیازمندی‌ها

- **Android 7.0** (API Level 24) یا بالاتر
- **دسترسی اینترنت** برای دانلود وبسایت‌ها
- **حداقل 100MB فضای خالی** برای ذخیره پروژه‌ها

## 🌟 نمونه‌های کاربرد

### بازی 2048
- آدرس: `2048.elkoob.ir`
- نوع: بازی وب پازل
- ویژگی: شامل JavaScript، CSS انیمیشن، لوکال استوریج

### سایت‌های آموزشی
- دانلود کامل محتوای آموزشی برای مطالعه آفلاین
- حفظ ساختار و عملکرد اصلی سایت

### نمونه‌کارهای طراحی
- ذخیره پروژه‌های طراحی وب
- مشاهده و تست در محیط موبایل

## 🔒 امنیت

- **Network Security Config**: تنظیمات امنیتی شبکه
- **Clear Text Traffic**: فقط برای localhost فعال
- **HTTPS Priority**: اولویت با پروتکل HTTPS
- **Safe Downloads**: بررسی ایمنی فایل‌های دانلودی

## 🐛 عیب‌یابی

### مشاهده Logs
```bash
adb logcat -s WebpageDownloadController WebpageDownloader HtmlUtil MainActivity
```

### مشکلات رایج
- **خطای "Unable to resolve"**: بررسی اتصال اینترنت
- **دانلود ناقص**: برخی سایت‌ها ممکن است از CORS محافظت کنند
- **فایل‌های مفقود**: منابع دینامیک ممکن است شناسایی نشوند

## 🤝 مشارکت

این پروژه به عنوان نمونه‌ای از کاربرد NanoHTTPD در اندروید طراحی شده است. برای پیشنهادات و بهبودها:

1. Fork کنید
2. شاخه جدید بسازید
3. تغییرات را commit کنید
4. Pull Request ایجاد کنید

## 📄 مجوز

این پروژه تحت مجوز MIT منتشر شده است.

## 👨‍💻 توسعه‌دهنده

ساخته شده با ❤️ برای جامعه توسعه‌دهندگان اندروید

---

**نکته**: این اپلیکیشن برای اهداف آموزشی و توسعه طراحی شده و برای استفاده تجاری نیاز به بررسی بیشتر دارد.